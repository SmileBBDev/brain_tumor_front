# brain_tumor_front 코드 품질 분석 보고서

> 최초 분석일: 2026-01-11
> 최종 업데이트: 2026-01-13

## 프로젝트 개요

| 항목 | 이전 (01-11) | 현재 (01-13) | 변화 |
|------|-------------|-------------|------|
| **파일 수** | 173개 | 210개 | +37개 |
| **스택** | React 19 + TypeScript + Vite + MUI 7 | 동일 | - |
| **용도** | 뇌종양 진료 관리 시스템 (CDSS) | 동일 | - |

---

## 개선 현황 요약

| 항목 | 이전 | 현재 | 상태 |
|------|------|------|------|
| `any` 타입 사용 | 9+ 파일 | 31개 파일, 46건 | 증가 |
| `alert()` 사용 | 26+ 파일 | 37개 파일, 94건 | 증가 |
| useCallback/useMemo | 거의 없음 | 38개 파일, 175건 | 개선 |
| 커스텀 훅 | 2개 | 4개 | 개선 |
| Toast 컴포넌트 | 없음 | 도입됨 (22개 파일) | 개선 |
| EncounterListPage | 262줄 | 18줄 (Widget 분리) | 개선 |

---

## 1. 중복 코드 패턴

### 개선됨: EncounterListPage 리팩토링

| 파일 | 이전 | 현재 | 상태 |
|------|------|------|------|
| `EncounterListPage.tsx` | 262줄 | 18줄 | 개선 |
| `EncounterListWidget.tsx` | - | 신규 | - |
| `EncounterListTable.tsx` | - | 신규 | - |

### 여전히 개선 필요

| 파일 | 라인 수 | 상태 |
|------|--------|------|
| `src/pages/imaging/ImagingListPage.tsx` | 292줄 | 미개선 |
| `src/pages/patient/PatientListPage.tsx` | 213줄 | 증가 |

### Modal 컴포넌트 중복 (심각도: 중간)

- `src/pages/imaging/ImagingCreateModal.tsx`
- `src/pages/encounter/EncounterCreateModal.tsx`
- `src/pages/patient/PatientCreateModal.tsx`

환자/의사 목록 로드 로직이 각 모달에서 반복됨

---

## 2. 타입 정의 문제

### `any` 타입 사용 (심각도: 높음) - 악화됨

**현재 현황**: 31개 파일, 46건

| 파일 | 건수 | 비고 |
|------|------|------|
| `src/pages/ocs/RISStudyDetailPage.tsx` | 6건 | 집중 개선 필요 |
| `src/utils/exportUtils.ts` | 5건 | - |
| `src/pages/imaging/ImagingReportModal.tsx` | 2건 | - |
| `src/pages/imaging/ImagingListTable.tsx` | 2건 | - |
| `src/pages/imaging/ImagingCreateModal.tsx` | 2건 | - |
| 기타 26개 파일 | 각 1건 | - |

**권장**: `AxiosError` 또는 `unknown` 타입 사용

---

## 3. 컴포넌트 구조 문제

### 거대 컴포넌트 (심각도: 높음)

| 파일 | 라인 수 | 문제점 |
|------|--------|--------|
| `src/pages/ocs/LISStudyDetailPage.tsx` | 1,477줄 | 매우 거대 |
| `src/pages/ocs/RISStudyDetailPage.tsx` | 1,087줄 | 매우 거대 |
| `src/pages/ocs/LISUploadPage.tsx` | 1,021줄 | 거대 |
| `src/pages/ocs/RISUploadPage.tsx` | 1,046줄 | 거대 |
| `src/pages/imaging/ImagingListPage.tsx` | 292줄 | 개선 필요 |

**권장 분리**:
- 데이터 로직 → 커스텀 훅으로 추출
- UI 섹션 → 하위 컴포넌트로 분리

---

## 4. API 호출 패턴

### 좋은 점

- `src/services/api.ts` - Axios 인스턴스 잘 구조화
- `src/services/imaging.api.ts` - 일관된 CRUD 패턴
- 401 에러 시 자동 토큰 갱신 처리

### 응답 타입 처리 불일치 (심각도: 높음)

배열/페이지네이션 객체 두 가지 응답을 컴포넌트마다 개별 처리:

```typescript
// 5개 이상 파일에서 반복
if (Array.isArray(response)) { ... }
else { setData(response.results || []); }
```

**권장**: 서비스 레이어에서 정규화

---

## 5. 에러 처리 패턴

### `alert()` 기반 에러 처리 (심각도: 높음) - 악화됨

**현재 현황**: 37개 파일, 94건

| 파일 | 건수 | 비고 |
|------|------|------|
| `src/pages/ocs/LISStudyDetailPage.tsx` | 16건 | 집중 개선 필요 |
| `src/pages/ocs/RISStudyDetailPage.tsx` | 15건 | 집중 개선 필요 |
| `src/pages/patient/tabs/TreatmentTab.tsx` | 6건 | - |
| `src/pages/imaging/ImagingReportModal.tsx` | 5건 | - |
| `src/pages/ocs/OCSDetailModal.tsx` | 5건 | - |
| 기타 32개 파일 | 각 1-4건 | - |

### 개선된 부분: Toast 컴포넌트 도입

- `src/components/common/Toast.tsx` 존재
- AI-inference, OCS Worklist 등 22개 파일에서 Toast 사용 중

---

## 6. 상태 관리 패턴

### 개선된 부분

| 항목 | 이전 | 현재 |
|------|------|------|
| useCallback/useMemo 사용 | 거의 없음 | 38개 파일, 175건 |
| 커스텀 훅 | useOCSList, useAIInference | +useOCSActions, useOCSNotification |

### 좋은 사례

- `src/hooks/useOCSList.ts` - 체계적 상태 관리
- `src/hooks/useAIInference.ts` - 명확한 인터페이스
- `src/hooks/useOCSActions.ts` - OCS 액션 분리
- `src/hooks/useOCSNotification.ts` - 실시간 알림 처리
- `src/pages/auth/AuthProvider.tsx` - 우수한 전역 상태 관리

---

## 이슈 요약 (업데이트)

| 순위 | 이슈 | 파일 수 | 영향도 | 수정 난이도 | 상태 |
|:----:|------|:------:|:------:|:----------:|:----:|
| 1 | 거대 컴포넌트 (LIS/RIS Detail) | 4 | 높음 | 높음 | 신규 |
| 2 | `alert()` 에러처리 | 37 | 높음 | 낮음 | 악화 |
| 3 | `any` 타입 사용 | 31 | 높음 | 낮음 | 악화 |
| 4 | ListPage 중복 구조 | 2 | 중간 | 중간 | 일부개선 |
| 5 | 응답 타입 불일치 | 5+ | 중간 | 중간 | 유지 |
| 6 | Modal 중복 구조 | 5+ | 중간 | 중간 | 유지 |

---

## 프로젝트 구조

### 페이지 구조 (LIS/RIS 대칭 구조)

```
pages/
├── lab/                    # LAB_RESULT_VIEW - 검사 결과 조회
│   ├── LabListPage.tsx
│   └── LabListTable.tsx
├── imaging/                # IMAGE_VIEWER - 영상 결과 조회
│   ├── ImagingListPage.tsx
│   ├── ImagingListTable.tsx
│   └── ...Modal.tsx
├── ocs/                    # OCS 워크리스트 (RIS/LIS 작업자용)
│   ├── LISWorklistPage.tsx     # OCS_LIS
│   ├── LISStudyDetailPage.tsx  # OCS_LIS_DETAIL
│   ├── LISUploadPage.tsx       # LAB_RESULT_UPLOAD
│   ├── LISProcessStatusPage.tsx # LIS_PROCESS_STATUS
│   ├── RISWorklistPage.tsx     # OCS_RIS
│   ├── RISStudyDetailPage.tsx  # OCS_RIS_DETAIL
│   ├── RISUploadPage.tsx       # RIS_RESULT_UPLOAD
│   └── RISProcessStatusPage.tsx # RIS_DASHBOARD
├── dashboard/
│   ├── lis/                # LIS 대시보드 컴포넌트
│   └── ris/                # RIS 대시보드 컴포넌트
└── ...
```

### 메뉴 구조 (routeMap)

```
IMAGING 그룹 (영상):
├── IMAGE_VIEWER        → ImagingListPage (영상 조회)
├── OCS_RIS             → RISWorklistPage (RIS 워크리스트)
├── OCS_RIS_DETAIL      → RISStudyDetailPage (상세)
├── RIS_DASHBOARD       → RISProcessStatusPage (처리 현황)
└── RIS_RESULT_UPLOAD   → RISUploadPage (결과 업로드)

LAB 그룹 (검사):
├── LAB_RESULT_VIEW     → LabListPage (검사 결과 조회)
├── LAB_RESULT_UPLOAD   → LISUploadPage (결과 업로드)
├── OCS_LIS             → LISWorklistPage (LIS 워크리스트)
├── OCS_LIS_DETAIL      → LISStudyDetailPage (상세)
└── LIS_PROCESS_STATUS  → LISProcessStatusPage (처리 현황)
```

---

## 이후 작업

### Phase 1: 긴급 (alert → Toast 전환)

| 우선순위 | 파일 | alert 건수 | 작업 내용 |
|:--------:|------|:----------:|----------|
| 1 | LISStudyDetailPage.tsx | 16건 | Toast로 전환 |
| 2 | RISStudyDetailPage.tsx | 15건 | Toast로 전환 |
| 3 | TreatmentTab.tsx | 6건 | Toast로 전환 |
| 4 | ImagingReportModal.tsx | 5건 | Toast로 전환 |
| 5 | OCSDetailModal.tsx | 5건 | Toast로 전환 |

### Phase 2: 타입 개선 (any → 적절한 타입)

| 우선순위 | 파일 | any 건수 | 작업 내용 |
|:--------:|------|:--------:|----------|
| 1 | RISStudyDetailPage.tsx | 6건 | AxiosError/unknown 사용 |
| 2 | exportUtils.ts | 5건 | 제네릭 타입 정의 |
| 3 | ImagingReportModal.tsx | 2건 | 적절한 타입 정의 |
| 4 | ImagingListTable.tsx | 2건 | 이벤트 타입 정의 |

### Phase 3: 거대 컴포넌트 분할

| 우선순위 | 파일 | 라인 수 | 분할 방안 |
|:--------:|------|:-------:|----------|
| 1 | LISStudyDetailPage.tsx | 1,477줄 | 섹션별 컴포넌트 분리 + 커스텀 훅 추출 |
| 2 | RISStudyDetailPage.tsx | 1,087줄 | 동일 |
| 3 | LISUploadPage.tsx | 1,021줄 | 업로드/미리보기/결과 섹션 분리 |
| 4 | RISUploadPage.tsx | 1,046줄 | 동일 |

### Phase 4: ListPage 위젯화

| 우선순위 | 파일 | 작업 내용 |
|:--------:|------|----------|
| 1 | ImagingListPage.tsx | ImagingListWidget 생성 (EncounterListWidget 참고) |
| 2 | PatientListPage.tsx | PatientListWidget 이미 존재, Page에 적용 |

### Phase 5: 폴더 구조 정리 (선택)

```
현재:
pages/imaging/  → IMAGE_VIEWER
pages/ocs/RIS*  → OCS_RIS 관련

권장 (LIS와 대칭):
pages/imaging/  → 유지 (또는 pages/ris/로 이름 변경)
pages/ocs/      → RIS/LIS 워크리스트 유지
```

**참고**: imaging과 RIS는 데이터 모델이 다르므로 통합하지 않음
- Imaging: ImagingStudy 기반 (영상 결과 조회용)
- RIS: OCS 기반 (작업자 워크플로우용)

---

## 참고: 삭제된 파일

| 파일 | 삭제일 | 사유 |
|------|--------|------|
| NurseReceptionPage.tsx | 2026-01-13 | NurseDashboard로 통합 |
| NurseReceptionPage.css | 2026-01-13 | 동일 |

---

## 변경 이력

| 날짜 | 내용 |
|------|------|
| 2026-01-11 | 최초 작성 |
| 2026-01-13 | 현재 상태로 업데이트, 이후 작업 추가 |
